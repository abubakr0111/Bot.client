import requests
from telegram import Update, ReplyKeyboardMarkup
from telegram.ext import ApplicationBuilder, CommandHandler, MessageHandler, ContextTypes, filters

TOKEN = '8003016348:AAGlIdYJaNXUdibbJgr5G6CwoSpEnWEsMlE'  # <-- Ð²ÑÑ‚Ð°Ð²ÑŒ ÑÑŽÐ´Ð° ÑÐ²Ð¾Ð¹ Ñ‚Ð¾ÐºÐµÐ½

# Ð“Ð»Ð°Ð²Ð½Ð¾Ðµ Ð¼ÐµÐ½ÑŽ Ñ ÐºÐ½Ð¾Ð¿ÐºÐ°Ð¼Ð¸
main_menu = ReplyKeyboardMarkup(
    [['ðŸ¤– Ðž Ð½Ð°Ñ', 'ðŸ’± ÐšÑƒÑ€Ñ'], ['âœ… AML Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ°', 'ðŸ›  Ð¡Ð²ÑÐ·Ð°Ñ‚ÑŒÑÑ']],
    resize_keyboard=True
)

# ÐŸÑ€Ð¸Ð²ÐµÑ‚ÑÑ‚Ð²ÐµÐ½Ð½Ð¾Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¸ /start
start_text = """Ð”Ð¾Ð±Ñ€Ð¾ Ð¿Ð¾Ð¶Ð°Ð»Ð¾Ð²Ð°Ñ‚ÑŒ Ð² Mosca!

ðŸ“ ÐœÐ¾ÑÐºÐ²Ð°, ÐŸÑ€ÐµÑÐ½ÐµÐ½ÑÐºÐ°Ñ Ð½Ð°Ð±ÐµÑ€ÐµÐ¶Ð½Ð°Ñ 12, Ð‘Ð°ÑˆÐ½Ñ Ð¤ÐµÐ´ÐµÑ€Ð°Ñ†Ð¸Ñ. Ð’Ð¾ÑÑ‚Ð¾Ðº, ÑÑ‚Ð°Ð¶ 11

ðŸ“… ÐœÑ‹ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÐ¼ Ð´Ð»Ñ Ð²Ð°Ñ 24/7. Ð‘ÐµÐ· Ð¾Ð±ÐµÐ´Ð° Ð¸ Ð²Ñ‹Ñ…Ð¾Ð´Ð½Ñ‹Ñ….

ðŸ’µ ÐœÑ‹ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÐ¼ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð·Ð° Ð½Ð°Ð»Ð¸Ñ‡Ð½Ñ‹Ðµ Ñ€ÑƒÐ±Ð»Ð¸.

ðŸ’¹ Ð¡Ð°Ð¼Ñ‹Ð¹ Ð½Ð¸Ð·ÐºÐ¸Ð¹ ÐºÑƒÑ€Ñ Ð½Ð° Ð¿Ð¾ÐºÑƒÐ¿ÐºÑƒ USDT Ð¸ Ð»ÑƒÑ‡ÑˆÐ¸Ð¹ ÐºÑƒÑ€Ñ Ð¿Ð¾ÐºÑƒÐ¿ÐºÐ¸ USDT Ð² ÐœÐ¾ÑÐºÐ²Ðµ.

ðŸ¤‘ ÐžÑ‚ÑÑƒÑ‚ÑÑ‚Ð²Ð¸Ðµ ÐºÐ°ÐºÐ¸Ñ…-Ð»Ð¸Ð±Ð¾ ÐºÐ¾Ð¼Ð¸ÑÑÐ¸Ð¹ Ð½Ð° Ð¿Ð¾ÐºÑƒÐ¿ÐºÑƒ Ð¸ Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ñƒ USDT

Ð”Ð»Ñ Ð¿Ð¾ÐºÑƒÐ¿ÐºÐ¸ USDT Ð½Ð°Ð¶Ð¼Ð¸Ñ‚Ðµ Ð½Ð° ÐºÐ½Ð¾Ð¿ÐºÑƒ "ÐžÐ±Ð¼ÐµÐ½"
"""

# Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ ÐºÑƒÑ€ÑÐ° USDT Ðº RUB Ñ CoinGecko
def get_usdt_rub_rate():
url = 'https://api.coingecko.com/api/v3/simple/price?ids=tether&vs_currencies=rub'
response = requests.get(url)
print(response.status_code)
print(response.text)

# ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ /start
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text(start_text, reply_markup=main_menu)

# ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ñ‚ÐµÐºÑÑ‚Ð¾Ð²Ñ‹Ñ… ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹ Ð¸ ÐºÐ½Ð¾Ð¿Ð¾Ðº
async def message_handler(update: Update, context: ContextTypes.DEFAULT_TYPE):
    msg = update.message.text

    if msg == 'ðŸ¤– Ðž Ð½Ð°Ñ':
        await update.message.reply_text("""Ð”Ð¾Ð±Ñ€Ð¾ Ð¿Ð¾Ð¶Ð°Ð»Ð¾Ð²Ð°Ñ‚ÑŒ Ð² Ð½Ð°Ñˆ Ð±Ð¾Ñ‚ Ð´Ð»Ñ Ð¾Ð±Ð¼ÐµÐ½Ð° ÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð²Ð°Ð»ÑŽÑ‚Ñ‹!

ðŸ’° ÐœÑ‹ Ð·Ð°Ð½Ð¸Ð¼Ð°ÐµÐ¼ÑÑ Ð¾Ð±Ð¼ÐµÐ½Ð¾Ð¼ ÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð²Ð°Ð»ÑŽÑ‚ Ð±Ð¾Ð»ÐµÐµ 3Ñ… Ð»ÐµÑ‚.
ðŸ“… ÐœÑ‹ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÐ¼ Ð´Ð»Ñ Ð²Ð°Ñ 24/7.
ðŸ’µ ÐœÑ‹ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÐ¼ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð·Ð° Ð½Ð°Ð»Ð¸Ñ‡Ð½Ñ‹Ðµ Ñ€ÑƒÐ±Ð»Ð¸.
ðŸ’¹ Ð£ Ð½Ð°Ñ Ð²Ñ‹ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ ÐºÑƒÐ¿Ð¸Ñ‚ÑŒ USDT Ð±ÐµÐ· ÐºÐ¾Ð¼Ð¸ÑÑÐ¸Ð¸ Ð¿Ð¾ ÑÐ°Ð¼Ð¾Ð¼Ñƒ Ð»ÑƒÑ‡ÑˆÐµÐ¼Ñƒ ÐºÑƒÑ€ÑÑƒ Ð² ÐœÐ¾ÑÐºÐ²Ðµ.  
ÐšÐ¾Ð¼Ð¸ÑÑÐ¸Ñ 3$ Ð·Ð° Ð²Ñ‹Ð²Ð¾Ð´ USDT Ð² ÑÐµÑ‚Ð¸ Tron.

ÐÐ°Ñˆ Ð°Ð´Ñ€ÐµÑ: ÐœÐ¾ÑÐºÐ²Ð°, ÐŸÑ€ÐµÑÐ½ÐµÐ½ÑÐºÐ°Ñ Ð½Ð°Ð±ÐµÑ€ÐµÐ¶Ð½Ð°Ñ 12, Ð‘Ð°ÑˆÐ½Ñ Ð¤ÐµÐ´ÐµÑ€Ð°Ñ†Ð¸Ñ. Ð’Ð¾ÑÑ‚Ð¾Ðº, ÑÑ‚Ð°Ð¶ 11

Ð”Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð¿Ñ€Ð¾Ð¿ÑƒÑÐºÐ° Ðº Ð½Ð°Ð¼ Ð² Ð¾Ñ„Ð¸Ñ Ð¸ Ð¿Ð¾ÐºÑƒÐ¿ÐºÐ¸ USDT, Ð²Ð°Ð¼ Ð½ÑƒÐ¶Ð½Ð¾ ÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ Ð·Ð°ÑÐ²ÐºÑƒ Ñ‡ÐµÑ€ÐµÐ· Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ""")

    elif msg == 'ðŸ’± ÐšÑƒÑ€Ñ':
        rate = get_usdt_rub_rate()
        if rate:
            await update.message.reply_text(f"""ÐšÑƒÑ€Ñ USDT Ðº RUB ÑÐµÐ¹Ñ‡Ð°Ñ Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ð½Ð¾:

ÐšÑƒÐ¿Ð¸Ñ‚ÑŒ 1 USDT = {rate:.2f} RUB  
ÐŸÑ€Ð¾Ð´Ð°Ñ‚ÑŒ 1 USDT = {rate - 1:.2f} RUB  Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ð½Ð¾ Ð½Ð° 1 Ñ€ÑƒÐ±Ð»ÑŒ Ð½Ð¸Ð¶Ðµ Ð¿Ð¾ÐºÑƒÐ¿ÐºÐ¸

*Ð´Ð°Ð½Ð½Ñ‹Ð¹ ÐºÑƒÑ€Ñ ÑÐ²Ð»ÑÐµÑ‚ÑÑ Ð±Ð¸Ñ€Ð¶ÐµÐ²Ñ‹Ð¼ Ð¸ Ð¼ÐµÐ½ÑÐµÑ‚ÑÑ ÐºÐ°Ð¶Ð´ÑƒÑŽ Ð¼Ð¸Ð½ÑƒÑ‚Ñƒ.

ÐšÐ¾Ð¼Ð¸ÑÑÐ¸Ñ 3$ Ð·Ð° Ð²Ñ‹Ð²Ð¾Ð´ USDT Ð² ÑÐµÑ‚Ð¸ Tron.

Ð”Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð¿Ñ€Ð¾Ð¿ÑƒÑÐºÐ° Ðº Ð½Ð°Ð¼ Ð² Ð¾Ñ„Ð¸Ñ Ð¸ Ð¿Ð¾ÐºÑƒÐ¿ÐºÐ¸ USDT, Ð½Ð°Ð¶Ð¼Ð¸Ñ‚Ðµ Ð½Ð° ÐºÐ½Ð¾Ð¿ÐºÑƒ "ÐžÐ±Ð¼ÐµÐ½" """)
        else:
            await update.message.reply_text("ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ñ‚ÐµÐºÑƒÑ‰Ð¸Ð¹ ÐºÑƒÑ€Ñ. ÐŸÐ¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ Ð¿Ð¾Ð·Ð¶Ðµ.")

    elif msg == 'âœ… AML Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ°':
        await update.message.reply_text("ðŸ”Ž Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð² Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐµ...")

    elif msg == 'ðŸ›  Ð¡Ð²ÑÐ·Ð°Ñ‚ÑŒÑÑ':
        await update.message.reply_text("""ÐÐ°ÑˆÐ¸ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€Ñ‹ Ð½Ð° ÑÐ²ÑÐ·Ð¸ 24/7 Ð¸ Ð³Ð¾Ñ‚Ð¾Ð²Ñ‹ Ð¾Ñ‚Ð²ÐµÑ‚Ð¸Ñ‚ÑŒ Ð½Ð° Ð»ÑŽÐ±Ñ‹Ðµ Ð²Ð°ÑˆÐ¸ Ð²Ð¾Ð¿Ñ€Ð¾ÑÑ‹.

Ð”Ð»Ñ ÑÐ²ÑÐ·Ð¸ Ñ Ð½Ð°Ð¼Ð¸ Ð½Ð°Ð¿Ð¸ÑˆÐ¸Ñ‚Ðµ â€” @Dolar_exchange_bot

Ð”Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð¿Ñ€Ð¾Ð¿ÑƒÑÐºÐ° Ðº Ð½Ð°Ð¼ Ð² Ð¾Ñ„Ð¸Ñ Ð¸ Ð¿Ð¾ÐºÑƒÐ¿ÐºÐ¸ USDT, Ð½Ð°Ð¶Ð¼Ð¸Ñ‚Ðµ Ð½Ð° ÐºÐ½Ð¾Ð¿ÐºÑƒ "ÐžÐ±Ð¼ÐµÐ½"
""")

    else:
        await update.message.reply_text("ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, Ð²Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ ÐºÐ½Ð¾Ð¿Ð¾Ðº Ð½Ð¸Ð¶Ðµ.", reply_markup=main_menu)

# Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð¸ Ð·Ð°Ð¿ÑƒÑÐºÐ°ÐµÐ¼ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ
app = ApplicationBuilder().token(TOKEN).build()
app.add_handler(CommandHandler("start", start))
app.add_handler(MessageHandler(filters.TEXT & (~filters.COMMAND), message_handler))

print("Ð‘Ð¾Ñ‚ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½!")
app.run_polling()
